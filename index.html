<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jeu de Devinette - Version Ultime</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #222831, #393e46);
      color: #eeeeee;
      text-align: center;
      padding: 30px;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background-color: #00adb5;
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 0 30px rgba(0, 173, 181, 0.5);
    }
    input, button {
      padding: 12px;
      font-size: 18px;
      border-radius: 10px;
      border: none;
      margin: 10px;
    }
    button {
      background-color: #393e46;
      color: white;
      cursor: pointer;
    }
    .hidden {
      display: none;
    }
    #feedback {
      font-size: 1.4em;
      margin: 20px 0;
    }
    #log {
      text-align: left;
      margin-top: 20px;
      max-height: 200px;
      overflow-y: auto;
      background-color: #eeeeee;
      color: black;
      padding: 10px;
      border-radius: 10px;
    }
    #highscores {
      margin-top: 20px;
      background-color: #eeeeee;
      color: black;
      padding: 10px;
      border-radius: 10px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>üéØ Jeu de Devinette üéØ</h1>
    <p>Devine le nombre secret !</p>
    <input type="text" id="playerName" placeholder="Entre ton pr√©nom" />
    <button onclick="startGame()">Commencer</button>

    <div id="game" class="hidden">
      <p id="levelInfo">Niveau : 1</p>
      <p id="attemptInfo">Tentatives : 0</p>
      <input type="number" id="guess" placeholder="1 - 20" />
      <button onclick="checkGuess()">Valider</button>
      <p id="feedback"></p>
      <div id="log"></div>
    </div>

    <div id="highscores">
      <h3>üèÜ Meilleurs scores</h3>
      <ul id="scoreList"></ul>
    </div>
  </div>

  <!-- Bruitage de victoire -->
  <audio id="winSound" src="https://www.myinstants.com/media/sounds/stage-complete.mp3"></audio>
  <!-- Musique de fond -->
  <audio id="bgMusic" src="https://files.catbox.moe/uc4kgx.mp3" loop autoplay></audio>

  <script>
    let secretNumber;
    let attempts = 0;
    let player = "";
    let level = 1;

    function getMaxRange(level) {
      return 20 + (level - 1) * 30;
    }

    function startGame() {
      player = document.getElementById("playerName").value || "Joueur";
      secretNumber = Math.floor(Math.random() * getMaxRange(level)) + 1;
      attempts = 0;
      document.getElementById("game").classList.remove("hidden");
      document.getElementById("guess").placeholder = `1 - ${getMaxRange(level)}`;
      document.getElementById("feedback").innerText = "";
      document.getElementById("log").innerHTML = "";
      updateInfo();
      document.getElementById("playerName").value = player;
      logMessage(`üéÆ Niveau ${level} | Devine un nombre entre 1 et ${getMaxRange(level)}`);
      localStorage.setItem("lastPlayer", player);
    }

    function updateInfo() {
      document.getElementById("levelInfo").innerText = `Niveau : ${level}`;
      document.getElementById("attemptInfo").innerText = `Tentatives : ${attempts}`;
    }

    function logMessage(message) {
      const log = document.getElementById("log");
      log.innerHTML += `<p>> ${message}</p>`;
      log.scrollTop = log.scrollHeight;
    }

    function checkGuess() {
      const guess = Number(document.getElementById("guess").value);
      if (!guess || guess < 1 || guess > getMaxRange(level)) {
        document.getElementById("feedback").innerText = `‚ùó Entrez un nombre entre 1 et ${getMaxRange(level)}`;
        return;
      }

      attempts++;
      updateInfo();

      if (guess === secretNumber) {
        document.getElementById("feedback").innerText = `‚úÖ Bravo ${player}, tu as trouv√© en ${attempts} tentatives !`;
        logMessage(`‚úÖ Bien jou√© ${player} ! Tu passes au niveau ${level + 1}`);
        saveHighscore(player, level);
        document.getElementById("winSound").play();
        level++;
        setTimeout(startGame, 2500);
      } else if (guess < secretNumber) {
        document.getElementById("feedback").innerText = "üîº Trop petit !";
      } else {
        document.getElementById("feedback").innerText = "üîΩ Trop grand !";
      }
    }

    function saveHighscore(name, score) {
      let scores = JSON.parse(localStorage.getItem("highscores")) || [];
      scores.push({ name, score });
      scores.sort((a, b) => b.score - a.score);
      scores = scores.slice(0, 5);
      localStorage.setItem("highscores", JSON.stringify(scores));
      updateHighscores();
    }

    function updateHighscores() {
      const scoreList = document.getElementById("scoreList");
      const scores = JSON.parse(localStorage.getItem("highscores")) || [];
      scoreList.innerHTML = scores.map(s => `<li>${s.name} - Niveau ${s.score}</li>`).join("");
    }

    window.onload = function () {
      const savedPlayer = localStorage.getItem("lastPlayer");
      if (savedPlayer) {
        document.getElementById("playerName").value = savedPlayer;
      }
      updateHighscores();
    };
  </script>
</body>

</html>
