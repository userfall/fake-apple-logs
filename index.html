<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Jeux Kabir – Bonneteau & Simon</title>
<style>
:root{
  --bg1:#0f0c29; --bg2:#302b63; --bg3:#24243e;
  --card:#10131aee; --muted:#aab3c4; --primary:#7cf5ff; --accent:#8b5cf6; --danger:#ff6b6b; --success:#22c55e; --gold:#facc15;
  --glass: rgba(255,255,255,0.08);
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", sans-serif;color:#eef3ff;background: linear-gradient(-45deg,var(--bg1),var(--bg2),var(--bg3));background-size:400% 400%;animation:bgMove 18s ease infinite;overflow-x:hidden;}
@keyframes bgMove{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
.container{max-width:1100px;margin:0 auto;padding:20px;}
.brand{display:flex;align-items:center;gap:10px;opacity:.9}
.brand .dot{width:10px;height:10px;border-radius:50%;background:var(--primary);box-shadow:0 0 12px var(--primary)}
.card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:22px;padding:20px;backdrop-filter:blur(8px);box-shadow:0 10px 30px rgba(0,0,0,.35)}
.section{margin-top:18px}
h1{font-size:clamp(26px,6vw,40px);margin-bottom:8px;text-align:center;}
h2{font-size:clamp(20px,5vw,28px);margin-bottom:10px;text-align:center;}
p,.muted{color:var(--muted);text-align:center;font-size:1rem;}
.btn{appearance:none;border:none;padding:14px 18px;border-radius:14px;cursor:pointer;font-weight:700;font-size:16px;color:#0b0f17;background:linear-gradient(135deg,#e0fbff,var(--primary));box-shadow:0 10px 20px rgba(124,245,255,.25), inset 0 1px 0 #fff;transition:.2s transform,.3s box-shadow,.2s filter;user-select:none;width:100%;max-width:250px;margin:auto;display:block}
.btn:active{transform:translateY(1px)}
.btn.ghost{background:transparent;color:#eef3ff;border:1px solid rgba(255,255,255,.15)}
.btn.warn{background:linear-gradient(135deg,#ffd1d1,var(--danger));box-shadow:0 10px 20px rgba(255,107,107,.25)}
.btn.ok{background:linear-gradient(135deg,#c9ffd7,var(--success));box-shadow:0 10px 20px rgba(34,197,94,.25)}
.grid{display:grid;gap:16px}
@media (min-width:860px){.grid.cols-2{grid-template-columns:1fr 1fr}}
.screen{display:none}
.screen.active{display:block}
.inputRow{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
input[type="text"]{flex:1;min-width:140px;padding:14px 16px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);color:#fff;font-size:16px;outline:none}
input::placeholder{color:#97a3b7}
.notice{margin-top:10px;font-weight:600;text-align:center;}
.tag{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.1);font-size:12px;margin:2px;}
.menuCard{display:grid;gap:16px;margin-top:20px}
.gameBtn{display:flex;align-items:center;gap:12px;padding:16px;border-radius:16px;background:var(--glass);border:1px solid rgba(255,255,255,.1);transition:.25s transform,.25s box-shadow;flex-direction:row;}
.gameBtn:hover{transform:translateY(-2px);box-shadow:0 14px 28px rgba(0,0,0,.35)}
.gameIcon{width:48px;height:48px;border-radius:14px;display:grid;place-items:center;background:#0b0f17;box-shadow:inset 0 1px 0 rgba(255,255,255,.1);font-size:24px;text-align:center;}
.footerHint{margin-top:18px;font-size:12px;opacity:.7;text-align:center;}
.particle{position:fixed;pointer-events:none;width:8px;height:8px;border-radius:50%;background:radial-gradient(circle,#fff,rgba(255,255,255,0));opacity:.2;animation:float 12s linear infinite}
@keyframes float{from{transform:translateY(110vh)}to{transform:translateY(-20vh)}}

/* Simon pads */
.padGrid{display:grid;grid-template-columns:repeat(2,150px);grid-template-rows:repeat(2,150px);gap:20px;justify-content:center;margin-top:20px;}
.pad{border-radius:16px;cursor:pointer;box-shadow:0 5px 15px rgba(0,0,0,.3);}
.pad.red{background:#ff4c4c;}
.pad.green{background:#4cff4c;}
.pad.blue{background:#4c4cff;}
.pad.yellow{background:#ffff4c;}
.pad.active{filter:brightness(1.5);}
.cup-container{display:flex;justify-content:center;align-items:flex-end;gap:60px;margin-top:50px;}
.cup{width:90px;height:120px;background:linear-gradient(to top,#c69c6d,#e0c097);border-radius:0 0 22px 22px;display:flex;justify-content:center;align-items:center;position:relative;cursor:pointer;transition:transform 0.4s ease;}
.bille{width:20px;height:20px;border-radius:50%;background:gold;position:absolute;top:10px;left:calc(50% - 10px);}
</style>
</head>
<body>
<div class="container">
<div class="brand"><span class="dot"></span><strong>Jeux Kabir</strong><span class="tag">Bonneteau & Simon</span></div>

<!-- INTRO -->
<section id="screen-intro" class="screen active card section">
<h1>Bienvenue 👋</h1>
<p class="muted">Accès réservé. Réponds correctement pour entrer.</p>
<div class="section">
<h2 id="questionLabel">Question 1/2</h2>
<p id="questionText" class="notice"></p>
<div class="inputRow section">
<input id="answerInput" type="text" placeholder="Ta réponse ici" autocomplete="off">
<button id="answerBtn" class="btn">Valider</button>
</div>
<p id="introMsg" class="notice"></p>
</div>
</section>

<!-- MENU -->
<section id="screen-menu" class="screen card section">
<h1>Menu principal</h1>
<p class="muted">Choisis un mini‑jeu. Bonne chance !</p>
<div class="menuCard grid cols-2">
<button class="gameBtn" id="btn-bonneteau"><div class="gameIcon">🎩</div><div><div style="font-weight:800">Bonneteau</div><div class="muted" style="font-size:13px">Suis la bille 😉</div></div></button>
<button class="gameBtn" id="btn-simon"><div class="gameIcon">🎨</div><div><div style="font-weight:800">Simon Game</div><div class="muted" style="font-size:13px">Mémorise la séquence</div></div></button>
</div>
<div class="hud section"><span class="tag">Musique : <span id="musicState">off</span></span><button id="toggleMusic" class="btn ghost">Activer/Désactiver</button></div>
</section>

<!-- BONNETEAU -->
<section id="screen-bonneteau" class="screen card section">
  <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap">
    <h2>Bonneteau 🎩</h2>
    <div class="hud">
      <span class="tag">Niveau <span id="bn-level">1</span></span>
      <span class="tag">Vitesse <span id="bn-speed">1.0x</span></span>
      <button class="btn ghost" id="bn-back">Retour menu</button>
    </div>
  </div>
  <div class="cup-container">
    <div class="cup" data-index="0"></div>
    <div class="cup" data-index="1"></div>
    <div class="cup" data-index="2"></div>
  </div>
  <div class="hud section">
    <button class="btn ok" id="bn-shuffle">Mélanger</button>
    <span class="tag">Choisis un gobelet après le mélange</span>
  </div>
  <p id="bn-msg" class="notice"></p>
</section>

<!-- SIMON -->
<section id="screen-simon" class="screen card section">
  <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap">
    <h2>Simon Game 🎨</h2>
    <div class="hud">
      <span class="tag">Niveau <span id="sm-level">1</span></span>
      <button class="btn ghost" id="sm-back">Retour menu</button>
    </div>
  </div>
  <div class="padGrid">
    <div class="pad red" data-pad="0"></div>
    <div class="pad green" data-pad="1"></div>
    <div class="pad blue" data-pad="2"></div>
    <div class="pad yellow" data-pad="3"></div>
  </div>
  <div class="hud section">
    <button class="btn ok" id="sm-start">Démarrer</button>
    <span class="tag">Répète la séquence</span>
  </div>
  <p id="sm-msg" class="notice"></p>
</section>

</div>

<audio id="bgm" loop preload="auto">
  <source src="https://cdn.pixabay.com/download/audio/2022/10/20/audio_d6a1a0f8bd.mp3?filename=cyber-dream-ambient-124841.mp3" type="audio/mpeg">
</audio>
<audio id="shuffle-sound" src="https://freesound.org/data/previews/66/66717_931655-lq.mp3"></audio>
<audio id="bille-sound" src="https://freesound.org/data/previews/331/331912_3248244-lq.mp3"></audio>
<audio id="simon0" src="https://freesound.org/data/previews/256/256113_3263906-lq.mp3"></audio>
<audio id="simon1" src="https://freesound.org/data/previews/256/256114_3263906-lq.mp3"></audio>
<audio id="simon2" src="https://freesound.org/data/previews/256/256115_3263906-lq.mp3"></audio>
<audio id="simon3" src="https://freesound.org/data/previews/256/256116_3263906-lq.mp3"></audio>

<script>
// ==== Utilities ====
const qs = s=>document.querySelector(s);
const qsa = s=>Array.from(document.querySelectorAll(s));
const show = id=>{qsa('.screen').forEach(el=>el.classList.remove('active')); qs('#'+id).classList.add('active');};

// Floating particles
for(let i=0;i<22;i++){
  const p=document.createElement('div');
  p.className='particle';
  p.style.left=Math.random()*100+'vw';
  p.style.animationDelay=(Math.random()*-12)+'s';
  p.style.opacity=.12+Math.random()*.25;
  document.body.appendChild(p);
}

// ==== Intro questions ====
const questions=[
  {text:"Qui est le meilleur ami de Kabir ?",answer:"jesus"},
  {text:"Qui est la première amoureuse de Kabir ?",answer:"francoise"}
];
let step=0;
const qLabel=qs('#questionLabel');
const qText=qs('#questionText');
const introMsg=qs('#introMsg');
const answerInput=qs('#answerInput');
const answerBtn=qs('#answerBtn');
function setQuestion(){qLabel.textContent=`Question ${step+1}/2`;qText.textContent=questions[step].text;answerInput.value='';introMsg.textContent='';answerInput.focus();}
function verifyCurrent(){
  const raw=(answerInput.value||'').trim().toLowerCase();
  if(!raw){introMsg.textContent='Entre une réponse.'; return;}
  if(step===0){ // première question
    if(raw===questions[0].answer){ enterMenu(); } // correct → menu
    else { step=1; setQuestion(); } // incorrect → deuxième question
  } else { // deuxième question
    if(raw===questions[1].answer){ enterMenu(); }
    else { introMsg.textContent='Raté ❌'; answerInput.value=''; }
  }
}
answerBtn.addEventListener('click',verifyCurrent);
answerInput.addEventListener('keydown',e=>{if(e.key==='Enter') verifyCurrent();});
setQuestion();

// ==== Music ====
const bgm=qs('#bgm'); const musicState=qs('#musicState'); const toggleMusic=qs('#toggleMusic'); let musicEnabled=false;
function tryStartMusic(){if(!musicEnabled){bgm.currentTime=0; bgm.play().then(()=>{musicEnabled=true; musicState.textContent='on';}).catch(()=>{});}}
toggleMusic.addEventListener('click',()=>{if(bgm.paused){bgm.play(); musicEnabled=true; musicState.textContent='on';} else {bgm.pause(); musicEnabled=false; musicState.textContent='off';}});

// ==== Menu nav ====
qs('#btn-bonneteau').addEventListener('click',()=>{ show('screen-bonneteau'); resetBonneteauUI(); });
qs('#btn-simon').addEventListener('click',()=>{ show('screen-simon'); resetSimon(); });
function enterMenu(){show('screen-menu'); tryStartMusic();}

// ===== BONNETEAU LOGIC =====
const cupEls=qsa('.cup'); const bnMsg=qs('#bn-msg'); const bnLevelEl=qs('#bn-level'); const bnSpeedEl=qs('#bn-speed');
let bnLevel=1; let bnBaseT=0.6; let cupPositions=[0,1,2]; let ballUnder=-1; let interactEnabled=false;
const shuffleSound=qs('#shuffle-sound'); const billeSound=qs('#bille-sound');

function resetBonneteauUI(){
  bnMsg.textContent='Regarde la bille…';
  interactEnabled=false;
  ballUnder=Math.floor(Math.random()*3);
  cupEls.forEach((cup,idx)=>{
    cup.innerHTML='';
    if(idx===ballUnder){
      const b=document.createElement('div'); b.className='bille'; cup.appendChild(b);
    }
  });
  cupPositions=[0,1,2];
}

function placeCups(){
  const spots=['20px','calc(50% - 60px)','calc(100% - 140px)'];
  for(let i=0;i<3;i++){
    const idx=cupPositions.indexOf(i);
    cupEls[i].style.transition=`transform ${bnBaseT}s ease`;
    cupEls[i].style.transform=`translateX(${spots[idx]})`;
  }
}

async function shuffleSequence(){
  interactEnabled=false; bnMsg.textContent='Mélange en cours…';
  shuffleSound.currentTime=0; shuffleSound.play();
  cupEls.forEach(cup=>{ cup.innerHTML=''; }); // cache bille
  const swaps=Math.min(6+bnLevel*2,30);
  bnBaseT=Math.max(0.22,0.6-bnLevel*0.04);
  bnSpeedEl.textContent=(0.6/bnBaseT).toFixed(1)+'x';
  for(let s=0;s<swaps;s++){
    const a=Math.floor(Math.random()*3); let b=Math.floor(Math.random()*3);
    while(b===a)b=Math.floor(Math.random()*3);
    [cupPositions[a],cupPositions[b]]=[cupPositions[b],cupPositions[a]];
    placeCups();
    await new Promise(r=>setTimeout(r,bnBaseT*1000+50));
  }
  bnMsg.textContent='À toi ! Choisis un gobelet.';
  interactEnabled=true;
}

cupEls.forEach(cup=>{ cup.addEventListener('click',()=>{
  if(!interactEnabled) return;
  const idx=parseInt(cup.dataset.index);
  if(cupPositions[idx]===ballUnder){
    bnMsg.textContent='Bravo 🎉';
    billeSound.currentTime=0; billeSound.play();
    bnLevel++; bnLevelEl.textContent=bnLevel;
    setTimeout(resetBonneteauUI,1000);
  } else {
    bnMsg.textContent='Raté ❌ La bille était ici.';
    setTimeout(resetBonneteauUI,1000);
  }
});});

qs('#bn-shuffle').addEventListener('click',shuffleSequence);
qs('#bn-back').addEventListener('click',()=>{enterMenu();});

// ===== SIMON LOGIC =====
const pads=qsa('.pad'); const smMsg=qs('#sm-msg'); const smLevelEl=qs('#sm-level');
const simonSounds=[qs('#simon0'),qs('#simon1'),qs('#simon2'),qs('#simon3')];
let smSequence=[]; let smUser=[]; let smLevel=1; let smPlaying=false;

function resetSimon(){smMsg.textContent='Clique sur démarrer'; smSequence=[]; smUser=[]; smLevel=1; smLevelEl.textContent=smLevel; smPlaying=false;}
function sleep(ms){return new Promise(r=>setTimeout(r,ms));}

async function playSimonSequence(){
  smPlaying=true; smMsg.textContent='Observe…';
  for(const p of smSequence){
    pads[p].classList.add('active'); simonSounds[p].currentTime=0; simonSounds[p].play();
    await sleep(600); pads[p].classList.remove('active'); await sleep(200);
  }
  smMsg.textContent='À toi !';
  smUser=[];
}

pads.forEach(pad=>{pad.addEventListener('click',()=>{ if(!smPlaying) return;
  const idx=parseInt(pad.dataset.pad);
  pad.classList.add('active'); simonSounds[idx].currentTime=0; simonSounds[idx].play();
  setTimeout(()=>pad.classList.remove('active'),300);
  smUser.push(idx);
  const currIdx=smUser.length-1;
  if(smUser[currIdx]!==smSequence[currIdx]){smMsg.textContent='Raté ❌'; smPlaying=false; setTimeout(resetSimon,1000); return;}
  if(smUser.length===smSequence.length){smLevel++; smLevelEl.textContent=smLevel; smSequence.push(Math.floor(Math.random()*4)); setTimeout(playSimonSequence,700);}
});});

qs('#sm-start').addEventListener('click',()=>{
  if(smPlaying) return;
  smSequence=[Math.floor(Math.random()*4)];
  playSimonSequence();
});
qs('#sm-back').addEventListener('click',()=>{enterMenu();});
</script>
</body>
</html>
